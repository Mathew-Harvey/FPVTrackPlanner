<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FPV Track Designer | Club Race Planner</title>
    <link href="https://fonts.googleapis.com/css2?family=Exo+2:wght@400;500;600;700;800&family=Bebas+Neue&display=swap" rel="stylesheet">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%2329b6f6'><path d='M12 2L2 7l10 5 10-5-10-5z'/></svg>">
<link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="loading-screen" id="loadingScreen">
        <div class="loading-spinner"></div>
        <div class="loading-text">Loading Track Designer</div>
    </div>

    <div class="notification" id="notification"></div>
    <div class="rotation-indicator" id="rotationIndicator">0Â°</div>

    <div id="canvas-container"></div>

    <div class="ui-overlay header">
        <div class="logo">
            <div class="logo-icon">
                <svg viewBox="0 0 24 24">
                    <path d="M12 2L2 7l10 5 10-5-10-5z"/>
                    <path d="M2 17l10 5 10-5"/>
                    <path d="M2 12l10 5 10-5"/>
                </svg>
            </div>
            <div class="logo-text">
                <h1>FPV Track Designer</h1>
                <span>Club Race Planner</span>
            </div>
        </div>
        <div class="mode-badge edit-mode" id="modeBadge">Edit Mode</div>
    </div>

    <div class="ui-overlay gates-panel">
        <div class="panel">
            <div class="panel-title">Race Gates</div>
            <div class="gate-item" data-gate="square" title="Standard 5Ã—5ft square gate">
                <div class="gate-icon">â–¢</div>
                <div class="gate-info"><h3>Square Gate</h3><span>5Ã—5 ft Standard</span></div>
            </div>
            <div class="gate-item" data-gate="arch" title="Curved arch gate">
                <div class="gate-icon">âŒ’</div>
                <div class="gate-info"><h3>Arch Gate</h3><span>Curved Top</span></div>
            </div>
            <div class="gate-item" data-gate="ladder" title="Triple stacked gates">
                <div class="gate-icon">âŠ</div>
                <div class="gate-info"><h3>Ladder Gate</h3><span>Stacked Triple</span></div>
            </div>
            <div class="gate-item" data-gate="hurdle" title="Low obstacle">
                <div class="gate-icon">âŠ“</div>
                <div class="gate-info"><h3>Hurdle</h3><span>Low Pass</span></div>
            </div>
            <div class="gate-item" data-gate="dive" title="Angled dive gate">
                <div class="gate-icon">â—‡</div>
                <div class="gate-info"><h3>Dive Gate</h3><span>Angled Entry</span></div>
            </div>
            <div class="gate-item" data-gate="flag" title="Turn marker">
                <div class="gate-icon">âš‘</div>
                <div class="gate-info"><h3>Flag Marker</h3><span>Turn Point</span></div>
            </div>
            <div class="selected-gate-info" id="selectedGateInfo">
                <h4>âœ“ <span id="selectedGateName"></span></h4>
                <p>Scroll wheel to rotate<br>DEL to delete â€¢ Drag to move</p>
                <div class="rotation-display">Angle: <span id="gateAngle">0Â°</span></div>
            </div>
        </div>
    </div>

    <div class="ui-overlay controls-panel">
        <div class="panel">
            <div class="panel-title">Track Controls</div>
            <button class="btn btn-primary" id="lockTrackBtn"><span>ğŸ”’</span> Lock Layout</button>
            <button class="btn btn-success" id="drawPathBtn" disabled><span>âœï¸</span> Draw Flight Path</button>
            <button class="btn btn-magenta" id="animateBtn" disabled><span>â–¶</span> Animate Drone</button>
            <div class="divider"></div>
            <button class="btn btn-secondary" id="undoBtn" disabled><span>â†©</span> Undo</button>
            <button class="btn btn-secondary" id="clearPathBtn" disabled><span>âœ•</span> Clear Path</button>
            <div class="divider"></div>
            <button class="btn btn-secondary" id="saveBtn"><span>ğŸ’¾</span> Save Track</button>
            <button class="btn btn-secondary" id="loadBtn"><span>ğŸ“‚</span> Load Track</button>
            <button class="btn btn-secondary" id="shareBtn"><span>ğŸ”—</span> Share Track</button>
            <div class="divider"></div>
            <button class="btn btn-danger btn-small" id="clearBtn"><span>ğŸ—‘</span> Clear All</button>
            <div class="track-info">
                <div class="track-stat"><span>Gates</span><span id="gateCount">0</span></div>
                <div class="track-stat"><span>Waypoints</span><span id="pathPoints">0</span></div>
                <div class="track-stat"><span>Track Length</span><span id="trackLength">0 m</span></div>
            </div>
        </div>
    </div>

    <div class="ui-overlay bottom-controls">
        <div class="control-group">
            <label>Speed</label>
            <input type="range" class="slider" id="speedSlider" min="1" max="10" value="5">
            <span class="slider-value" id="speedValue">5x</span>
        </div>
        <div class="control-group">
            <label>Height</label>
            <input type="range" class="slider" id="heightSlider" min="0.5" max="15" step="0.5" value="3">
            <span class="slider-value" id="heightValue">3.0m</span>
        </div>
    </div>

    <div class="ui-overlay instructions">
        <div class="panel">
            <div class="panel-title">Controls</div>
            <div class="instruction-item"><span class="key">LMB</span><span>Select/drag gates</span></div>
            <div class="instruction-item"><span class="key">RMB</span><span>Rotate camera</span></div>
            <div class="instruction-item"><span class="key">Scroll</span><span>Zoom / Rotate gate</span></div>
            <div class="instruction-item"><span class="key">MMB</span><span>Pan camera</span></div>
            <div class="instruction-item"><span class="key">DEL</span><span>Delete selected</span></div>
            <div class="instruction-item"><span class="key">ESC</span><span>Cancel / Deselect</span></div>
            <div class="panel-title" style="margin-top:8px;margin-bottom:6px;">Path Mode</div>
            <div class="instruction-item"><span class="key">Drag</span><span>Trace flight path</span></div>
            <div class="instruction-item"><span class="key">Scroll</span><span>Adjust altitude</span></div>
        </div>
    </div>

    <!-- Modals -->
    <div class="modal-overlay" id="saveModal">
        <div class="modal">
            <h2>ğŸ’¾ Save Track</h2>
            <input type="text" id="trackName" placeholder="Track Name">
            <textarea id="trackDescription" placeholder="Description (optional)"></textarea>
            <input type="text" id="authorName" placeholder="Your Name">
            <div class="modal-buttons">
                <button class="btn btn-secondary" onclick="closeModal('saveModal')">Cancel</button>
                <button class="btn btn-primary" onclick="saveTrack()">Save</button>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="loadModal">
        <div class="modal">
            <h2>ğŸ“‚ Load Track</h2>
            <p>Paste track JSON data:</p>
            <textarea id="loadData" placeholder='{"name":"...","gates":[...]}'></textarea>
            <div class="modal-buttons">
                <button class="btn btn-secondary" onclick="closeModal('loadModal')">Cancel</button>
                <button class="btn btn-primary" onclick="loadTrack()">Load</button>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="shareModal">
        <div class="modal">
            <h2>ğŸ”— Share Track</h2>
            <p>Copy and share with club members:</p>
            <textarea id="shareData" readonly style="font-size:0.7rem;height:100px;"></textarea>
            <div class="modal-buttons">
                <button class="btn btn-secondary" onclick="closeModal('shareModal')">Close</button>
                <button class="btn btn-secondary" onclick="downloadTrack()">â¬‡ Download</button>
                <button class="btn btn-primary" onclick="copyShareData()">ğŸ“‹ Copy</button>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="script.js"></script>

</body>
</html>
